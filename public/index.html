<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>FLV 下载管理</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="layout">
    <aside class="sider">
      <a class="menu-item" href="#/home">首页</a>
      <a class="menu-item" href="#/explore">探索</a>
      <a class="menu-item" href="#/downloads">下载管理</a>
      <a class="menu-item" href="#/settings">设置</a>
      <a class="menu-item" href="#" id="logoutBtn">退出登录</a>
    </aside>
    <main class="content">
      <div class="container">
        <section id="homeView" style="display:none">
          <div class="panel">
            <h2>首页</h2>
            <p>左侧菜单可进入探索、下载管理与设置。</p>
            <div style="margin:8px 0;display:flex;gap:8px;align-items:center;">
              <button class="form-btn" id="schedulerToggleBtn">定时任务：加载中...</button>
              <button class="form-btn" id="manualUpdateBtn">手动刷新收藏直播间地址</button>
            </div>
            <div id="homeFavorites" class="grid"></div>
          </div>
        </section>

        <section id="exploreView" style="display:none">
          <div class="panel">
            <h2>探索</h2>
            <div id="exploreBreadcrumb" class="breadcrumb"></div>
            <div class="explore-wrapper">
              <div class="explore-main">
                <div id="exploreList" class="grid"></div>
              </div>
              <div class="explore-side">
                <div class="panel">
                  <h2>收藏的平台</h2>
                  <div class="side-scroll">
                    <table class="side-table">
                      <thead><tr><th>名称</th><th>信息</th><th>操作</th></tr></thead>
                      <tbody id="favPlatforms"></tbody>
                    </table>
                  </div>
                </div>
                <div class="panel">
                  <h2>屏蔽的平台</h2>
                  <div class="side-scroll">
                    <table class="side-table">
                      <thead><tr><th>名称</th><th>信息</th><th>操作</th></tr></thead>
                      <tbody id="blkPlatforms"></tbody>
                    </table>
                  </div>
                </div>
                <div class="panel">
                  <h2>收藏的播放</h2>
                  <div class="side-scroll">
                    <table class="side-table">
                      <thead><tr><th>名称</th><th>信息</th><th>操作</th></tr></thead>
                      <tbody id="favChannels"></tbody>
                    </table>
                  </div>
                </div>
                <div class="panel">
                  <h2>屏蔽的播放</h2>
                  <div class="side-scroll">
                    <table class="side-table">
                      <thead><tr><th>名称</th><th>信息</th><th>操作</th></tr></thead>
                      <tbody id="blkChannels"></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="downloadView" style="display:none">
          <div class="top">
            <form id="downloadForm">
              <input type="text" id="title" placeholder="主播名（如：KK）" required />
              <input type="url" id="url" placeholder="视频地址（http://...flv）" required />
              <button type="submit">提交下载</button>
            </form>
            <form id="parseForm">
              <textarea id="parseText" rows="1" placeholder="粘贴文本（如：KK ffmpeg -i `http://...flv` -q 0 -f flv ./KK20250101123000.flv）" required></textarea>
              <button type="submit">解析并下载</button>
            </form>
          </div>
          <section class="panel">
            <h2>下载任务</h2>
            <table class="task-table">
              <thead>
                <tr>
                  <th>任务名</th>
                  <th>直播间</th>
                  <th>视频URL</th>
                  <th>任务创建时间</th>
                  <th>状态</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody id="taskList"></tbody>
            </table>
            <div class="pager">
              <button id="taskPrev">上一页</button>
              <span id="taskInfo"></span>
              <button id="taskNext">下一页</button>
            </div>
          </section>
        </section>

        <section id="settingsView" style="display:none">
          <div class="panel">
            <h2>设置</h2>
            <div class="form-row">
              <div class="form-label">定时调度时间间隔：</div>
              <div style="display:flex;gap:8px;align-items:center;">
                <input class="form-input" type="number" id="intervalInput" placeholder="请输入分钟数" min="1" max="60" />
                <span class="form-suffix">分钟</span>
              </div>
              <button class="form-btn" id="saveInterval">保存</button>
            </div>
            <div class="form-row">
              <div class="form-label">基础地址：</div>
              <input class="form-input" type="url" id="baseUrlInput" placeholder="如：http://api.hclyz.com:81/mf/" />
              <button class="form-btn" id="saveBaseUrl">保存</button>
            </div>
            <div class="form-row">
              <div class="form-label">原密码：</div>
              <input class="form-input" type="password" id="oldPwd" placeholder="请输入当前管理员密码" />
              <button class="form-btn" id="savePwd">修改密码</button>
            </div>
            <div class="form-row">
              <div class="form-label">新密码：</div>
              <input class="form-input" type="password" id="newPwd" placeholder="至少 8 位" />
            </div>
            <div class="form-row">
              <div class="form-label">确认新密码：</div>
              <input class="form-input" type="password" id="newPwd2" placeholder="再次输入新密码" />
              <span id="pwdMsg" class="form-suffix"></span>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script src="./app.js"></script>
</body>
</html>